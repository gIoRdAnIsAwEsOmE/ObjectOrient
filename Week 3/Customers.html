<html>
	<head>
		<style>
			table, th, td {
				border: 1px solid black;
			}
		</style>
	</head>
	<body>
	Candy <input id="newcandy"></input>
	<button onclick="submit();">Submit</button>
	<br>
	Find the amount of candy in each store: <select id="dropdown" onchange="find();"></select>
	<table id="output">
		<tr>
			<td>Candy</td><td>Cost</td><td>Expiration</td><td>ID</td>
		</tr>
	</table>
	<script src="https://code.jquery.com/jquery-3.1.0.js"></script>
	<script src="https://cloudboost.io/js-sdk/cloudboost.js"></script>
	<script src="Store.js"></script>
	<script src="Candy.js"></script>
	<script src="StoreCandy.js"></script>
	<script>
		let storequery = new CB.CloudQuery("Store");
		let candyquery = new CB.CloudQuery("Candy");
	    function setUpDropdown(){ // proves the dropdown list
			let dropdown = $("#dropdown");
			storequery.find({
				success : (res) => {
					console.log(res);
					for(let r of res){
						r = r.document;
						dropdown.html(dropdown.html() + "<option value>" + r.name + "</option>");
					}
				} 
			});
	    }
		
		function find(){
			let selected = $('#dropdown :selected').text();
			storequery.equalTo('name', selected);
			storequery.find({
				success : (res) => {
					for(let r of res){
						let store_id = r.document.store_id;
						let finder = new StoreCandy(store_id);
						finder.getBounds("Store", "#output");
						
					}
					
				}	
			});
		}
	    setUpDropdown();
	</script>
</html>